(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{1115:function(t,e,r){"use strict";r(17),r(13),r(8),r(7),r(3),r(6),r(9),r(5),r(10);var o=["class","staticClass","style","staticStyle","attrs"];function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t,e){if(null==t)return{};var r,o,n=function(t,e){if(null==t)return{};var r,o,n={},s=Object.keys(t);for(o=0;o<s.length;o++)r=s[o],e.indexOf(r)>=0||(n[r]=t[r]);return n}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)r=s[o],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}e.a={functional:!0,render:function(t,e){var r=e._c,i=(e._v,e.data),c=e.children,u=void 0===c?[]:c,l=i.class,p=i.staticClass,f=i.style,d=i.staticStyle,m=i.attrs,b=void 0===m?{}:m,h=a(i,o);return r("svg",function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({class:[l,p],style:[f,d],attrs:Object.assign({width:"50",height:"50",viewBox:"0 0 50 50",fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid"},b)},h),u.concat([r("path",{attrs:{d:"M31.801 4.49c1.75-.364 3.53-.451 5.156-.525l-6.745 6.744-.292.293v.414c0 .245.006 1.075.405 2.283.187.653.426 1.37.72 2.03.29.652.665 1.325 1.155 1.815s1.162.865 1.814 1.155c.667.296 1.393.537 2.051.725l.055.016.055.009c.525.087.963.175 1.301.243l.009.001c.162.033.311.063.431.084.093.017.261.047.411.047h.414l.293-.293 6.935-6.935-.002.057c-.076 1.729-.157 3.57-.534 5.38-.427 2.05-1.22 3.97-2.754 5.504-1.992 1.992-4.114 2.799-6.235 2.962h-.007c-2.008.168-4.051-.165-5.977-.69l-.573-.157-.411.429-17.518 18.24c-.293.29-.664.41-1.188.582l-.221.073c-.117.039-.456.027-.784-.3L5.25 40.159l-.07-.07-.083-.055c-.075-.05-.243-.267-.126-.732l.03-.12v-.123c0-.328.138-.626.603-1.092l18.24-17.518.429-.412-.157-.573c-.522-1.914-.854-3.945-.693-5.942.334-2.128 1.322-4.29 3.006-6.319 1.432-1.5 3.327-2.286 5.373-2.712zm6.075-.558l-.006-.002.006.002z",stroke:"currentColor","stroke-width":"2"}})]))}}},1485:function(t,e,r){"use strict";var o={props:{title:String,content:{type:Object,default:function(){return{}}}},mounted:function(){window.scrollTo(0,0)},computed:{showSubtitle:function(){return this.content.showSubtitle||!1},subtitle:function(){return this.content.subtitle||null},forwardButton:function(){return this.content.forwardButton||null},backButton:function(){return this.content.backButton||null}}},n=r(2),s=Object(n.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.title?r("div",{staticClass:"text-x5 mb-4"},[t._v(t._s(t.title))]):t._e(),t._v(" "),t.showSubtitle&&t.subtitle?r("div",[t._v(t._s(t.subtitle))]):t._e(),t._v(" "),r("div",{staticClass:"flex flex-wrap flex-col mt-8"},[t.forwardButton?r("div",[r("div",{staticClass:"button button_primary w-full mb-2",on:{click:function(e){return t.$emit("forward-click")}}},[r("span",{staticClass:"button__span-after"},[t._v("\n          "+t._s(t.forwardButton.title)+"\n        ")])])]):t._e(),t._v(" "),t.backButton?r("div",[r("div",{staticClass:"button button_secondary w-full",on:{click:function(e){return t.$emit("back-click")}}},[r("span",{staticClass:"button__span-after"},[t._v("\n          "+t._s(t.backButton.title)+"\n        ")])])]):t._e()])])}),[],!1,null,null,null);e.a=s.exports},1538:function(t,e,r){},1964:function(t,e,r){"use strict";r(7),r(3),r(9),r(10),r(8),r(5);var o=r(15),n=r(18),s=r(1485);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}var i={props:{popupData:{type:Object,default:function(){return{}}}},data:function(){return{popupTitle:"Пароль успешно изменен!"}},mounted:function(){window.scrollTo(0,0)},computed:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){Object(o.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},Object(n.e)("personal/personal",["isAuthPopup"])),components:{PopupSuccessContent:s.a}},c=r(2),u=Object(c.a)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.isAuthPopup?r("div",[r("PopupSuccessContent",{attrs:{content:t.popupData,title:t.popupTitle},on:{"forward-click":function(e){return t.$emit("forward-click")},"back-click":function(e){return t.$emit("close-popup")}}})],1):r("div",{staticClass:"py-12 desktop1440:pt-16"},[r("g-padding",[r("g-container",[r("div",{staticClass:"form__response py-12 tablet:py-16 desktop:py-20"},[r("h1",{staticClass:"text-x5 tablet:text-x4 mb-4"},[t._v("\n          Пароль успешно изменен\n        ")]),t._v(" "),r("div",{staticClass:"form__response-buttons mt-2 tablet:mt-4"},[r("div",{staticClass:"form__response-buttons-item"},[r("div",{staticClass:"button button_primary w-full",on:{click:function(e){return t.$emit("close-message")}}},[r("span",{staticClass:"button__span-after"},[t._v("\n                Перейти в личный кабинет\n              ")])])]),t._v(" "),r("div",{staticClass:"form__response-buttons-item"},[r("div",{staticClass:"button button_secondary w-full",on:{click:function(e){return t.$emit("to-main")}}},[r("span",{staticClass:"button__span-after"},[t._v("\n                На главную\n              ")])])])])])])],1)],1)}),[],!1,null,null,null);e.a=u.exports},1965:function(t,e,r){"use strict";r(7),r(3),r(9),r(10),r(8),r(5);var o=r(15),n=r(18),s=r(1485);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}var i={props:{popupData:{type:Object,default:function(){return{}}}},data:function(){return{popupTitle:"Вы успешно зарегистрированы!"}},mounted:function(){window.scrollTo(0,0)},computed:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){Object(o.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},Object(n.e)("personal/personal",["isAuthPopup"]),{isLoggedIn:function(){return this.$auth.loggedIn},content:function(){return this.isLoggedIn?this.popupData:Object.assign(this.popupData,{forwardButton:{title:"Авторизоваться"}})}}),components:{PopupSuccessContent:s.a}},c=r(2),u=Object(c.a)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.isAuthPopup?r("div",[r("PopupSuccessContent",{attrs:{content:t.content,title:t.popupTitle},on:{"forward-click":function(e){return t.$emit("forward-click")},"back-click":function(e){return t.$emit("close-popup")}}})],1):r("div",{staticClass:"py-12 desktop1440:pt-16"},[r("g-padding",[r("g-container",[r("div",{staticClass:"form__response py-12 tablet:py-16 desktop:py-20"},[r("h1",{staticClass:"text-x5 tablet:text-x4 mb-4"},[t._v("\n          Вы успешно зарегистрированы!\n        ")]),t._v(" "),r("div",{staticClass:"form__response-buttons mt-2 tablet:mt-4"},[t.isLoggedIn?r("div",{staticClass:"form__response-buttons-item"},[r("div",{staticClass:"button button_primary w-full",on:{click:function(e){return t.$emit("close-message")}}},[r("span",{staticClass:"button__span-after"},[t._v("\n                Перейти в личный кабинет\n              ")])])]):r("div",{staticClass:"form__response-buttons-item"},[r("div",{staticClass:"button button_primary w-full",on:{click:function(e){return t.$emit("to-personal-page")}}},[r("span",{staticClass:"button__span-after"},[t._v("\n                Авторизоваться\n              ")])])]),t._v(" "),r("div",{staticClass:"form__response-buttons-item"},[r("div",{staticClass:"button button_secondary w-full",on:{click:function(e){return t.$emit("to-main")}}},[r("span",{staticClass:"button__span-after"},[t._v("\n                На главную\n              ")])])])])])])],1)],1)}),[],!1,null,null,null);e.a=u.exports},2005:function(t,e,r){"use strict";r(7),r(3),r(9),r(10),r(8),r(5);var o=r(15),n=r(14),s=r.n(n),a=r(382),i=r(162),c=(r(60),r(36),r(6),r(107)),u=r(1017),l=r(76),p={data:function(){return{form:{phone:null,name:null,surname:null,email:null,agree_personal:null,agree_account:null}}},props:{commonError:String,isDataLoading:Boolean,needScroll:Boolean,agreement:{type:Object,default:function(){return{}}}},methods:{onSubmit:function(){this.$emit("submit-form",this.form)},setErrors:function(t){this.$refs.form.setErrors(t)}},activated:function(){this.needScroll&&window.scrollTo(0,0)},components:{Loader:c.a,LicenseButton:u.a,ValidationProvider:l.b,ValidationObserver:l.a}},f=r(2),d=Object(f.a)(p,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ValidationObserver",{ref:"form",scopedSlots:t._u([{key:"default",fn:function(e){var o=e.handleSubmit;return[r("form",{on:{submit:function(e){return e.preventDefault(),o(t.onSubmit)}}},[r("fieldset",{staticClass:"is-full"},[r("ul",[r("li",[r("ValidationProvider",{attrs:{vid:"phone",rules:"required|phone"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("g-form-control",{directives:[{name:"mask",rawName:"v-mask",value:"+7 (###) ###-##-##",expression:"'+7 (###) ###-##-##'"}],attrs:{type:"text",label:"Ваш номер телефона",placeholder:"+7 (___) ___-__-__",error:o[0],autocomplete:"off"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})]}}],null,!0)})],1),t._v(" "),r("li",[r("ValidationProvider",{attrs:{vid:"name",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("g-form-control",{attrs:{type:"text",label:"Имя",error:o[0],autocomplete:"off"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})]}}],null,!0)})],1),t._v(" "),r("li",[r("ValidationProvider",{attrs:{vid:"surname",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("g-form-control",{attrs:{type:"text",label:"Фамилия",error:o[0],autocomplete:"off"},model:{value:t.form.surname,callback:function(e){t.$set(t.form,"surname",e)},expression:"form.surname"}})]}}],null,!0)})],1),t._v(" "),r("li",[r("ValidationProvider",{attrs:{vid:"email",rules:"required|email"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("g-form-control",{attrs:{type:"text",label:"Email",error:o[0],autocomplete:"off"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})]}}],null,!0)})],1),t._v(" "),r("li",{staticClass:"pt-3"},[r("ValidationProvider",{attrs:{vid:"agree_personal",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("g-form-control",{attrs:{id:"agree_personal",name:"agree_personal",type:"checkbox",error:o[0],"has-label":!1},model:{value:t.form.agree_personal,callback:function(e){t.$set(t.form,"agree_personal",e)},expression:"form.agree_personal"}},[r("template",{slot:"label"},[r("LicenseButton",{attrs:{agreement:t.agreement,smallText:!0}})],1)],2)]}}],null,!0)})],1),t._v(" "),r("li",{staticClass:"pt-3"},[r("ValidationProvider",{attrs:{vid:"agree_account",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("g-form-control",{attrs:{id:"agree_account",name:"agree_account",type:"checkbox",error:o[0],"has-label":!1},model:{value:t.form.agree_account,callback:function(e){t.$set(t.form,"agree_account",e)},expression:"form.agree_account"}},[r("template",{slot:"label"},[r("div",{staticClass:"w-full text-s3"},[t._v("\n                  Проставляя отметку, Вы даете согласие с\n                  "),r("a",{attrs:{href:"/info/account/",target:"_blank"}},[t._v("условиями доступа в личный кабинет")])])])],2)]}}],null,!0)})],1)])]),t._v(" "),r("div",{staticClass:"mt-2 tablet:mt-4"},[r("button",{staticClass:"button button_primary",attrs:{type:"submit"}},[t.isDataLoading?[r("Loader",{attrs:{inline:!0,white:!0}})]:[r("span",{staticClass:"button__span-after"},[t._v("\n            Зарегистрироваться\n          ")])]],2)]),t._v(" "),t.commonError?r("div",{staticClass:"form-control__error"},[t._v("\n      "+t._s(t.commonError)+"\n    ")]):t._e()])]}}])})}),[],!1,null,"bc8b84a4",null).exports,m={props:{commonError:String,isDataLoading:Boolean},data:function(){return{form:{password:null,password_confirmation:null,remember_me:null}}},methods:{onSubmit:function(){this.$emit("submit-password-form",this.form)},setErrors:function(t){this.$refs.form.setErrors(t)},togglePassword:function(t){"password-input"===t?this.$refs["password-input-confirm"].togglePassword():this.$refs["password-input"].togglePassword()}},activated:function(){window.scrollTo(0,0),this.form.password=null,this.form.password_confirmation=null,this.form.remember_me=null},components:{Loader:c.a,ValidationProvider:l.b,ValidationObserver:l.a}},b=Object(f.a)(m,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("ValidationObserver",{ref:"form",scopedSlots:t._u([{key:"default",fn:function(e){var o=e.handleSubmit;return[r("form",{on:{submit:function(e){return e.preventDefault(),o(t.onSubmit)}}},[r("fieldset",{staticClass:"is-full"},[r("ul",[r("li",[r("ValidationProvider",{attrs:{vid:"password",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("g-form-control",{ref:"password-input",attrs:{id:"password-input",type:"password",label:"Пароль",error:o[0],autocomplete:"off"},on:{"toggle-password":t.togglePassword},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})]}}],null,!0)})],1),t._v(" "),r("li",[r("ValidationProvider",{attrs:{vid:"password_confirmation",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("g-form-control",{ref:"password-input-confirm",attrs:{id:"password-input-confirm",type:"password",label:"Повторите пароль",error:o[0],autocomplete:"off"},on:{"toggle-password":t.togglePassword},model:{value:t.form.password_confirmation,callback:function(e){t.$set(t.form,"password_confirmation",e)},expression:"form.password_confirmation"}})]}}],null,!0)})],1)])]),t._v(" "),r("div",{staticClass:"mt-2 tablet:mt-4"},[r("button",{staticClass:"button button_primary",attrs:{type:"submit"}},[t.isDataLoading?[r("Loader",{attrs:{inline:!0,white:!0}})]:[t._v("\n            Продолжить\n          ")]],2)]),t._v(" "),t.commonError?r("div",{staticClass:"form-control__error"},[t._v("\n        "+t._s(t.commonError)+"\n      ")]):t._e()])]}}])})],1)}),[],!1,null,"0eacd25e",null).exports,h=r(1525),v={props:{phone:String,expirationDate:Number,commonError:String,isDataLoading:Boolean},data:function(){return{form:{code:null}}},methods:{onSubmit:function(){this.$emit("check-confirm-code",this.form.code)},resendPhone:function(){this.$emit("resend-confirm-code")},setErrors:function(t){this.$refs.form.setErrors(t)}},activated:function(){window.scrollTo(0,0),this.form.code=null},components:{Timer:h.a,Loader:c.a,ValidationProvider:l.b,ValidationObserver:l.a}},g=Object(f.a)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("ValidationObserver",{ref:"form",scopedSlots:t._u([{key:"default",fn:function(e){var o=e.handleSubmit;return[r("form",{on:{submit:function(e){return e.preventDefault(),o(t.onSubmit)}}},[r("fieldset",{staticClass:"is-full"},[r("ul",[r("li",[r("ValidationProvider",{attrs:{vid:"code",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("g-form-control",{attrs:{type:"text",label:"Код из смс",error:o[0],autocomplete:"off"},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})]}}],null,!0)})],1)])]),t._v(" "),r("div",{staticClass:"mt-2 tablet:mt-4"},[r("button",{staticClass:"button button_primary",attrs:{type:"submit"}},[t.isDataLoading?[r("Loader",{attrs:{inline:!0,white:!0}})]:[t._v("\n            Подтвердить\n          ")]],2)]),t._v(" "),t.commonError?r("div",{staticClass:"form-control__error"},[t._v("\n        "+t._s(t.commonError)+"\n      ")]):t._e(),t._v(" "),r("Timer",{ref:"timer",staticClass:"mt-5",attrs:{expirationTime:t.expirationDate},on:{resend:t.resendPhone}})],1)]}}])})],1)}),[],!1,null,"14b14f3a",null).exports,_=r(18),w=r(11),O=r(1030),y=r(34),P=r(1119),k=r(165),S=r(24);function C(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function j(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?C(Object(r),!0).forEach((function(e){Object(o.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var D={mixins:[r(1016).a,O.a,P.a,y.a,S.a],data:function(){return{isDataLoading:!1,currentStepIndex:0,steps:{form:d,confirm:g,password:b},needScroll:!1,draftPhone:null,formData:{},confirmCode:null,expirationDate:null,commonFormError:null,commonConfirmError:null,commonPasswordError:null}},props:{agreement:{type:Object,default:function(){return{}}}},computed:j({},Object(_.e)("personal/personal",["isAuthPopup"]),{currentStep:{get:function(){return this.steps[this.currentStepName]},set:function(t){this.needScroll=!this.isFormStep,this.currentStepIndex=t}},currentStepName:function(){return this.stepNames[this.currentStepIndex]},stepNames:function(){return Object.keys(this.steps)},isFormStep:function(){return"form"===this.currentStepName},isConfirmStep:function(){return"confirm"===this.currentStepName},isPasswordStep:function(){return"password"===this.currentStepName}}),methods:j({},Object(_.b)("basket",["loadBasketCount"]),{setDataLoading:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isDataLoading=t},nextStep:function(){this.currentStep=this.currentStepIndex+1},prevStep:function(){this.currentStep=this.currentStepIndex-1},getCurrentStepProps:function(){switch(this.currentStepName){case"form":return this.getFormStepProps();case"confirm":return this.getConfirmStepProps();case"password":return this.getPasswordStepProps();default:return{}}},getFormStepProps:function(){return{commonError:this.commonFormError,isDataLoading:this.isDataLoading,agreement:this.agreement,needScroll:this.needScroll}},getConfirmStepProps:function(){return{phone:this.formData.phone,expirationDate:this.expirationDate,isDataLoading:this.isDataLoading,commonError:this.commonConfirmError}},getPasswordStepProps:function(){return{isDataLoading:this.isDataLoading,commonError:this.commonPasswordError}},onSubmitPasswordForm:function(t){var e=this;this.isDataLoading||(this.setDataLoading(),this.commonPasswordError=null,this.$axios(w.a.registerUser(this.getRegisterFormData(t))).then((function(r){if(0===r.data.error&&r.data.content.user){e.gtagEventByType("","created");var o=new FormData;o.append("username",e.formData.phone),o.append("password",t.password),e.$auth.loginWith("local",{data:o}).then((function(){e.deleteCookie("buyer_id"),e.gtagEventByType("","login"),e.isAuthPopup?(e.$emit("registered"),e.$router.push(e.$route.path.slice(0,-1))):e.$auth.$storage.setState("fromRegistration",!0)})).catch((function(){e.$emit("user-register"),e.currentStep=0,e.setStepOptions()})).finally((function(){e.loadBasketCount(e.isAuthPopup),e.setDataLoading(!1)}))}else e.commonPasswordError=e.getMessageByCode("errors.server"),e.setDataLoading(!1)})).catch((function(t){if(e.setDataLoading(!1),t instanceof k.a){var r=e.prepareValidateErrors(t.data);r.password?e.setPasswordErrors(r):e.commonPasswordError=e.errorsToString(r)}else e.commonPasswordError=e.getMessageByCode("errors.server")})))},onCheckConfirmCode:function(t){var e=this;this.isDataLoading||(this.confirmCode=t,this.commonConfirmError=null,this.commonPasswordError=null,this.setDataLoading(),this.$axios(w.a.checkRegisterCode(this.formData.phone,this.confirmCode)).then((function(t){0===t.data.error&&"true"===t.data.content.success?(e.nextStep(),e.setStepOptions()):0===t.data.error&&"true"!==t.data.content.success?e.setConfirmErrors({code:[e.getMessageByCode("errors.wrong_code")+t.data.content.success]}):e.setConfirmDefaultErrors(t.data.content.error_data),e.setDataLoading(!1)})).catch((function(t){e.setDataLoading(!1),t instanceof k.a?e.setConfirmErrors(e.prepareValidateErrors(t.data)):e.setConfirmDefaultErrors()})))},onResendConfirmCode:function(){var t=this;if(!this.isDataLoading){this.setDataLoading(),this.commonConfirmError=null,this.commonPasswordError=null;var e=Object.assign({},this.formData,{retry:!0});this.$axios(w.a.sendRegisterCode(this.appendObjectToFormData(e))).then((function(e){0===e.data.error&&e.data.content.expiration_date?t.expirationDate=e.data.content.expiration_date:t.setConfirmDefaultErrors(),t.setDataLoading(!1)})).catch((function(e){t.setDataLoading(!1),e instanceof k.a?t.setConfirmErrors(t.prepareValidateErrors(e.data)):t.setConfirmDefaultErrors()}))}},onSubmitForm:function(t){var e=this;this.isDataLoading||(this.setDataLoading(),this.draftPhone=t.phone,this.formData=this.prepareFormData(t),this.commonFormError=null,this.commonConfirmError=null,this.commonPasswordError=null,this.$axios(w.a.sendRegisterCode(this.appendObjectToFormData(this.formData))).then((function(t){0===t.data.error&&t.data.content.expiration_date?(e.expirationDate=t.data.content.expiration_date,e.nextStep(),e.setStepOptions()):e.commonFormError=e.getMessageByCode("errors.server"),e.setDataLoading(!1)})).catch((function(t){e.setDataLoading(!1),t instanceof k.a&&e.setFormErrors(e.prepareValidateErrors(t.data))})))},errorsToString:function(t){var e="",r=function(r){t[r].forEach((function(t){e=e+r+": "+t+". "}))};for(var o in t)r(o);return e.slice(0,-2)},setConfirmDefaultErrors:function(t){this.setConfirmErrors({code:[t||this.getMessageByCode("errors.server")]})},setFormErrors:function(t){this.isFormStep&&this.$refs.currentStep.setErrors(t)},setConfirmErrors:function(t){this.isConfirmStep&&this.$refs.currentStep.setErrors(t)},setPasswordErrors:function(t){this.isPasswordStep&&this.$refs.currentStep.setErrors(t)},appendObjectToFormData:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var r in null===e&&(e=new FormData),t)e.append(r,t[r]);return e},getRegisterFormData:function(t){t.remember_me=Number(t.remember_me);var e=this.appendObjectToFormData(this.formData);return(e=this.appendObjectToFormData(t,e)).append("code",this.confirmCode),e},prepareFormData:function(t){return Object.assign({},t,{agree_personal:Number(t.agree_personal),agree_account:Number(t.agree_account),phone:this.preparePhone(t.phone)})},onBackButtonClick:function(){this.currentStep=0,this.setStepOptions()},setStepOptions:function(){var t={};switch(this.currentStepName){case"form":t={showTabs:!0,showBackButton:!1,formTitles:null};break;case"confirm":t={showTabs:!1,showBackButton:!0,formTitles:{title:"Подтвердите номер",subTitle:'СМС с кодом отправлено на номер <br> <span class="color-black">'.concat(this.draftPhone,"</span>")}};break;case"password":t={showTabs:!1,showBackButton:!0,formTitles:{title:"Придумайте пароль",subTitle:this.getMessageByCode("password.title")}}}this.$emit("set-options",t)}}),components:{Register:d,SetPassword:b,ConfirmPhone:g}},E=Object(f.a)(D,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("keep-alive",[r(t.currentStep,t._b({ref:"currentStep",tag:"component",on:{"prev-step":function(e){return t.prevStep()},"submit-form":t.onSubmitForm,"resend-confirm-code":t.onResendConfirmCode,"check-confirm-code":t.onCheckConfirmCode,"submit-password-form":t.onSubmitPasswordForm}},"component",t.getCurrentStepProps(),!1))],1)}),[],!1,null,"b28075b6",null).exports;r(27),r(43);function x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function $(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach((function(e){Object(o.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var T={mixins:[y.a,S.a],props:{backTo:String},data:function(){return{form:{phone:null,password:null,remember:null},isDataLoading:!1,loginError:!1}},computed:$({},Object(_.e)("personal/personal",["isAuthPopup"])),methods:$({},Object(_.b)("basket",["loadBasketCount"]),{},Object(_.d)("watched",["clearState"]),{},Object(_.d)("user-results",["clearUserResults"]),{onSubmit:function(){var t=this;if(!this.isDataLoading){var e=new FormData;e.append("username",this.preparePhone(this.form.phone)),e.append("password",this.form.password);var r=this.$auth.loginWith("local",{data:e});this.isDataLoading=!0,r.then((function(e){1===e.data.error&&"user_is_not_confirmed_exception"===e.data.content.error_code?t.$emit("user-imported",t.form.phone):(t.gtagEventByType("","login"),t.isAuthPopup&&(t.$emit("logged-in"),t.$router.push(t.$route.path.slice(0,-1))),t.backTo&&t.$router.push(t.backTo)),t.deleteCookie("buyer_id"),t.clearState(),t.clearUserResults(),t.loginError=!1})).catch((function(e){t.loginError=!0})).finally((function(){t.loadBasketCount(t.isAuthPopup),t.isDataLoading=!1}))}},preparePhone:function(t){return t.replace(/[^0-9]/g,"")}}),components:{Loader:c.a,ValidationProvider:l.b,ValidationObserver:l.a}},B=(r(2030),Object(f.a)(T,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("ValidationObserver",{ref:"form",scopedSlots:t._u([{key:"default",fn:function(e){var o=e.handleSubmit;return[r("form",{attrs:{autocomplete:"off"},on:{submit:function(e){return e.preventDefault(),o(t.onSubmit)}}},[r("fieldset",{staticClass:"is-full"},[r("ul",[r("li",[r("ValidationProvider",{attrs:{vid:"phone",rules:"required|phone"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("g-form-control",{directives:[{name:"mask",rawName:"v-mask",value:"+7 (###) ###-##-##",expression:"'+7 (###) ###-##-##'"}],attrs:{type:"text",label:"Ваш номер телефона",placeholder:"+7 (___) ___-__-__",autocomplete:"new-login",error:o[0]},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})]}}],null,!0)})],1),t._v(" "),r("li",[r("ValidationProvider",{attrs:{vid:"password",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors;return[r("g-form-control",{attrs:{type:"password",label:"Пароль",autocomplete:"new-password",error:o[0]},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})]}}],null,!0)}),t._v(" "),t.loginError?r("div",{staticClass:"form-control__error w-1/2 mobile375:w-auto"},[t._v("\n              Неверный логин или пароль\n            ")]):t._e(),t._v(" "),r("div",{staticClass:"form__note text-right text-s3"},[r("a",{staticClass:"form__note-link",on:{click:function(e){return t.$emit("user-imported")}}},[t._v("\n                Забыли пароль?\n              ")])])],1)])]),t._v(" "),r("div",{staticClass:"mt-2 tablet:mt-4"},[r("button",{staticClass:"button button_primary",attrs:{type:"submit"}},[t.isDataLoading?[r("Loader",{attrs:{inline:!0,white:!0}})]:[r("span",{staticClass:"button__span-after"},[t._v("\n              Войти\n            ")])]],2)])])]}}])})],1)}),[],!1,null,"1bcfc8d8",null).exports),L=r(1964),F=r(1485);function R(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}var V={props:{popupData:{type:Object,default:function(){return{}}}},data:function(){return{popupTitle:"Вы успешно авторизованы!"}},mounted:function(){window.scrollTo(0,0)},computed:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?R(Object(r),!0).forEach((function(e){Object(o.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},Object(_.e)("personal/personal",["isAuthPopup"])),components:{PopupSuccessContent:F.a}},I=Object(f.a)(V,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.isAuthPopup?r("PopupSuccessContent",{attrs:{content:t.popupData,title:t.popupTitle},on:{"forward-click":function(e){return t.$emit("forward-click")},"back-click":function(e){return t.$emit("close-popup")}}}):t._e()}),[],!1,null,null,null).exports,N=r(1965),A=r(2004);function M(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function q(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?M(Object(r),!0).forEach((function(e){Object(o.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var U={props:{titles:{type:Object,default:function(){return{}}},isPopup:{type:Boolean,default:!1},successPopupData:{type:Object,default:function(){return{}}}},data:function(){return{phone:null,activeTab:0,showTabs:!0,isRestored:!1,isLoggedIn:!1,isRegistered:!1,showBackButton:!1,showRecoveryForm:!1,formTitles:this.titles,tabs:["Вход","Регистрация"],back_to:this.$route.params.back_to||null,defaultFormTitles:{title:"Личный кабинет",subTitle:'Уже регистрировались на сайте <a href="https://www.kia.ru">kia.ru</a>? Используйте ваши данные, чтобы войти.'}}},created:function(){this.isPopup&&(this.loadPage(),this.setIsAuthPopup(!0))},computed:q({},Object(_.e)("personal/personal",["agreement"]),{formTitle:function(){return s()(this.formTitles)?this.defaultFormTitles.title:this.formTitles.title},formSubTitle:function(){return s()(this.formTitles)?this.defaultFormTitles.subTitle:this.formTitles.subTitle}}),methods:q({},Object(_.b)("personal/personal",["loadPage"]),{},Object(_.d)("personal/personal",["setIsAuthPopup"]),{onBackButtonClick:function(){this.$refs.register?this.$refs.register.onBackButtonClick():this.$refs.restore&&this.$refs.restore.onBackButtonClick()},selectTab:function(t){this.activeTab=t},setOptions:function(t){void 0!==t.showTabs&&(this.showTabs=t.showTabs),void 0!==t.formTitles&&(this.formTitles=t.formTitles||this.titles),void 0!==t.showBackButton&&(this.showBackButton=t.showBackButton)},onUserImported:function(t){this.showRecoveryForm=!0,this.phone=t},onRecoveryBackClick:function(){this.showRecoveryForm=!1,this.showBackButton=!1,this.showTabs=!0,this.formTitles=this.titles},onUserRegister:function(){this.isRegistered=!0},toPersonalPage:function(){this.isRegistered=!1,this.selectTab(0)},toMainPage:function(){this.$nuxt.$router.push({path:"/"})},closePopup:function(){this.$emit("close-popup")},forwardClick:function(){this.$router.push(this.successPopupData.forwardButton.route)}}),destroyed:function(){this.isPopup&&this.setIsAuthPopup(!1)},components:{NavTabs:a.a,Register:E,FormLogin:B,IconTickLeft:i.a,SuccessRestored:L.a,SuccessLoggedIn:I,SuccessRegistered:N.a,FormRestorePassword:A.a}},z=Object(f.a)(U,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"form__body"},[t.isLoggedIn?r("SuccessLoggedIn",{attrs:{"popup-data":t.successPopupData},on:{"forward-click":t.forwardClick,"close-popup":function(e){return t.$emit("close-popup")}}}):t.isRegistered?r("SuccessRegistered",{attrs:{"popup-data":t.successPopupData},on:{"to-main":t.toMainPage,"to-personal-page":t.toPersonalPage,"forward-click":t.forwardClick,"close-popup":function(e){return t.$emit("close-popup")}}}):t.isRestored?r("SuccessRestored",{attrs:{"popup-data":t.successPopupData},on:{"forward-click":t.forwardClick,"close-popup":function(e){return t.$emit("close-popup")}}}):[t.showBackButton?r("g-container",[r("div",{staticClass:"breadcrumb-back text-s2-b pb-4"},[r("button",{staticClass:"inline-flex items-center p-0",on:{click:function(e){return t.onBackButtonClick()}}},[r("icon-tick-left"),t._v("\n          Назад\n        ")],1)])]):t._e(),t._v(" "),t.formTitle?r("div",{class:["text-x5 mb-4",{"tablet:hidden":!t.isPopup}]},[t._v("\n      "+t._s(t.formTitle)+"\n    ")]):t._e(),t._v(" "),t.formSubTitle?r("div",{staticClass:"color-disabled-gray mb-6 tablet:mb-8 desktop1440:text-s1-r",domProps:{innerHTML:t._s(t.formSubTitle)}}):t._e(),t._v(" "),t.showRecoveryForm?r("FormRestorePassword",{ref:"restore",attrs:{steps:["confirm","code","password","final"],showRestoreByEmail:!1},on:{back:t.onRecoveryBackClick,"set-options":t.setOptions,"close-popup":t.closePopup,restored:function(e){t.isRestored=!0}}}):r("div",[t.showTabs?r("NavTabs",{staticClass:"mb-2",attrs:{tabs:t.tabs,activeTabIndex:t.activeTab},on:{"select-tab":t.selectTab}}):t._e(),t._v(" "),0===t.activeTab?[r("FormLogin",{attrs:{"back-to":t.back_to},on:{"logged-in":function(e){t.isLoggedIn=!0},"user-imported":t.onUserImported,"close-popup":t.closePopup}})]:[r("Register",{ref:"register",attrs:{agreement:t.agreement},on:{"set-options":t.setOptions,"user-register":t.onUserRegister,"close-popup":t.closePopup,registered:function(e){t.isRegistered=!0}}})]],2)]],2)}),[],!1,null,null,null);e.a=z.exports},2030:function(t,e,r){"use strict";var o=r(1538);r.n(o).a}}]);